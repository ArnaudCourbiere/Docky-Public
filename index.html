<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Docky Swipe Launcher by ArnaudCourbiere</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <link rel="stylesheet" href="stylesheets/phone.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Docky Swipe Launcher</h1>
        <p>Swipe dock made of awesomeness.</p>

        <p class="view"><a href="https://github.com/ArnaudCourbiere/DockySwipeLauncher">View the Project on GitHub <small>ArnaudCourbiere/DockySwipeLauncher</small></a></p>


        <ul>
          <!-- <li><a href="https://github.com/ArnaudCourbiere/DockySwipeLauncher/zipball/master">Download <strong>ZIP File</strong></a></li> -->
          <!-- <li><a href="https://github.com/ArnaudCourbiere/DockySwipeLauncher/tarball/master">Download <strong>TAR Ball</strong></a></li> -->
          <li><a href="https://github.com/ArnaudCourbiere/DockySwipeLauncher">View On <strong>GitHub</strong></a></li>
          <li><a href="https://plus.google.com/communities/100159096177469176535">Join the beta On <strong>Google+</strong></a></li>
          <li><a href="https://github.com/ArnaudCourbiere/DockySwipeLauncher/issues">Report an <strong>Issue</strong></a></li>
        </ul>
      </header>
      <section>
        <!-- <p><img src="https://raw.github.com/ArnaudCourbiere/DockySwipeLauncher/master/phone.png" alt="alt tag"></p> -->
        <p>
          <div id="phone">
            <div id="screen">
              <div id="dock">
                <div class="dock-item gmail-item"></div>
                <div class="dock-item hangout-item"></div>
                <div class="dock-item chrome-item"></div>
                <div class="dock-item calculator-item"></div>
              </div>
            </div>
          </div>
        </p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/ArnaudCourbiere">ArnaudCourbiere</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/lib/scale.fix.js"></script>

    <script data-dojo-config="async: 1, dojoBlankHtmlUrl: '/path/to/blank.html',
        packages: [{
            name: 'src',
            location: '/javascripts/src'
        }]"
    src="//ajax.googleapis.com/ajax/libs/dojo/1.9.2/dojo/dojo.js"></script>

    <script>
        require(['src/util', 'dojo/touch', 'dojo/on', 'dojo/dom', 'dojo/dom-geometry', 'dojo/dom-style', 'dojo/_base/fx', 'dojo/domReady!'],
            function bootstrap (util, touch, on, dom, domGeo, domStyle, fx) {
                var screen = dom.byId('screen');
                var dock = dom.byId('dock');
                var down = false;
                var dockGeo = domGeo.position(dock);
                var dockCurrentWidth = dockGeo.w;
                var initialX = 0;
                
                var mouseDownHandler = function (event) {
                    down = true;
                    initialX = event.x ? event.x : event.clientX;
                    initialY = event.y ? event.y : event.clientY;
                    
                    //util.cancelEvent(event);
                };
                
                var mouseMoveHandler = function (event) {
                    if (down === true) {
                        dockCurrentWidth -= (event.x ? event.x : event.clientX) - initialX;
                        
                        if (dockCurrentWidth < 0) {
                            dockCurrentWidth = 0;
                        } else if (dockCurrentWidth > dockGeo.w) {
                            dockCurrentWidth = dockGeo.w;
                        }
                        
                        domStyle.set(dock, 'width', dockCurrentWidth + 'px');
                        
                        initialX = event.x ? event.x : event.clientX;
                    }
                    
                    util.cancelEvent(event);
                };
                
                var mouseUpHandler = function (event) {
                    down = false;
                    initialX = 0;
                    var targetWidth = dockCurrentWidth > dockGeo.w / 2 ? dockGeo.w : 0;
                    
                    fx.animateProperty({
                        node: 'dock',
                        properties: {
                            width: targetWidth
                        },
                        onEnd: function () {
                            dockCurrentWidth = targetWidth;
                        }
                    }).play();
                    
                    util.cancelEvent(event);
                };
                
                on(screen, 'mousedown', mouseDownHandler);
                on(window, 'mousemove', mouseMoveHandler);
                on(window, 'mouseup', mouseUpHandler);
                
                on(screen, touch.press, mouseDownHandler);
                on(window, touch.move, mouseMoveHandler);
                on(window, touch.release, mouseUpHandler);
            }
        );

    </script>
    
  </body>
</html>
